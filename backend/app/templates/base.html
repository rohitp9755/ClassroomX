<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>{% block title %}ClassroomX{% endblock %}</title>
  <script src="https://cdn.tailwindcss.com"></script>
</head>
<body class="bg-gray-50 text-gray-900">
  {% block sidebar_included %}{% set sidebar_included = true %}{% endblock %}
  {% block content %}
    {% if sidebar_included %}
      <div class="min-h-screen flex">
        <!-- Hamburger Toggle using Checkbox Hack -->
        <input type="checkbox" id="sidebar-toggle" class="hidden peer" />
        <label for="sidebar-toggle" class="fixed top-4 left-4 z-40 p-2 rounded-full bg-white border shadow md:hidden cursor-pointer">
          <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 6h16M4 12h16M4 18h16" />
          </svg>
        </label>
        <label for="sidebar-toggle" class="fixed inset-0 bg-black bg-opacity-40 z-30 hidden peer-checked:block md:hidden cursor-pointer"></label>
        <aside class="fixed inset-y-0 left-0 w-64 bg-white border-r shadow-lg z-40 -translate-x-full peer-checked:translate-x-0 rounded-r-xl transition-transform duration-200 ease-in-out md:relative md:rounded-none md:shadow-none md:translate-x-0 md:block">
          <div class="flex items-center justify-between p-4 border-b">
            <span class="font-bold text-xl">ClassroomX</span>
            <label for="sidebar-toggle" class="md:hidden cursor-pointer p-1 text-gray-500 hover:text-black">
              <svg xmlns="http://www.w3.org/2000/svg" class="h-6 w-6" viewBox="0 0 20 20" fill="currentColor">
                <path fill-rule="evenodd" d="M10 8.586l4.95-4.95a1 1 0 111.414 1.415l-4.95 4.95 4.95 4.95a1 1 0 01-1.414 1.414l-4.95-4.95-4.95 4.95A1 1 0 015.05 14.95l4.95-4.95-4.95-4.95A1 1 0 016.464 3.636L10 7.172l3.536-3.536A1 1 0 1114.95 5.05L10 10l.707.707.707.707 4.95-4.95A1 1 0 1116.364 4.222l-4.95 4.95z" clip-rule="evenodd" />
              </svg>
            </label>
          </div>
          <nav class="p-4 flex flex-col gap-1 font-medium text-gray-700 h-full">
            <a href="/" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" stroke-width="2" viewBox="0 0 24 24"><path d="M3 12l2-2m0 0l7-7 7 7M5 10v10a1 1 0 001 1h3m10-11l2 2m-2-2v10a1 1 0 01-1 1h-3m-6 0h6" stroke-linecap="round" stroke-linejoin="round"/></svg>
              Home
            </a>
            <a href="/classes" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect width="18" height="14" x="3" y="5" rx="2"/></svg>
              Classes
            </a>
            <a href="/calendar" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect width="18" height="18" x="3" y="3" rx="2"/><path d="M16 2v4M8 2v4M3 10h18"/></svg>
              Calendar
            </a>
            <a href="/todo" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><rect width="18" height="14" x="3" y="5" rx="2"/><path d="M9 9h6M9 13h6"/></svg>
              To-do
            </a>
            <a href="/settings" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">
              <svg class="w-5 h-5" fill="none" stroke="currentColor" viewBox="0 0 24 24"><circle cx="12" cy="12" r="3"/><path d="M19.4 15a1.65 1.65 0 00.33 1.82l.06.06a2 2 0 01-2.83 2.83l-.06-.06a1.65 1.65 0 00-1.82-.33 1.65 1.65 0 00-1 1.51V21a2 2 0 01-4 0v-.09a1.65 1.65 0 00-1-1.51 1.65 1.65 0 00-1.82.33l-.06.06a2 2 0 01-2.83-2.83l.06-.06a1.65 1.65 0 00.33-1.82 1.65 1.65 0 00-1.51-1H3a2 2 0 010-4h.09a1.65 1.65 0 001.51-1 1.65 1.65 0 00-.33-1.82l-.06-.06a2 2 0 012.83-2.83l.06.06a1.65 1.65 0 001.82.33h.09a1.65 1.65 0 001-1.51V3a2 2 0 014 0v.09a1.65 1.65 0 001 1.51 1.65 1.65 0 001.82-.33l.06-.06a2 2 0 012.83 2.83l-.06.06a1.65 1.65 0 00-.33 1.82v.09a1.65 1.65 0 001.51 1H21a2 2 0 010 4h-.09a1.65 1.65 0 00-1.51 1z"/></svg>
              Settings
            </a>
            <div class="mt-4 mb-1 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider">Account</div>
            {% if not current_user.is_authenticated %}
              <div class="flex flex-col gap-2">
                <a href="/auth/login" class="block px-4 py-2 rounded hover:bg-gray-100 text-blue-600 font-semibold transition">Login</a>
                <a href="/auth/signup" class="block px-4 py-2 rounded hover:bg-gray-100 text-blue-600 font-semibold transition">Sign up</a>
              </div>
            {% else %}
              {% if current_user.role == 'teacher' %}
                <div class="mt-4 mb-1 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider">Teaching</div>
                <a href="/teacher/dashboard" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">Teacher Dashboard</a>
                <a href="/teacher/classes/new" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">New Class</a>
              {% elif current_user.role == 'student' %}
                <div class="mt-4 mb-1 px-4 text-xs font-bold text-gray-400 uppercase tracking-wider">Enrolled</div>
                <a href="/student/dashboard" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">Student Dashboard</a>
                <a href="/student/classes/join" class="flex items-center gap-2 px-4 py-2 rounded hover:bg-gray-100 transition">Join Class</a>
              {% endif %}
              <a href="/auth/logout" class="block px-4 py-2 mt-4 rounded hover:bg-gray-100 text-red-600 font-semibold transition">Logout</a>
            {% endif %}
            <div class="flex-1"></div>
          </nav>
        </aside>
        <main class="flex-1 p-4 md:p-8 ml-0 md:ml-64 transition-all duration-200">
          {{ super() }}
        </main>
      </div>
    {% else %}
      {{ super() }}
    {% endif %}
  {% endblock %}
</body>
</html>
